(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-index-index"],{"0c47":function(t,e,n){var a=n("da84"),r=n("d44e");r(a.JSON,"JSON",!0)},"0e86":function(t,e,n){"use strict";n.r(e);var a=n("7bd2"),r=n("a21d");for(var i in r)["default"].indexOf(i)<0&&function(t){n.d(e,t,(function(){return r[t]}))}(i);n("ddd4");var o=n("f0c5"),s=Object(o["a"])(r["default"],a["b"],a["c"],!1,null,"a4d60abc",null,!1,a["a"],void 0);e["default"]=s.exports},"120f":function(t,e,n){"use strict";n("7a82");var a=n("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.base64ToPath=function(t){return new Promise((function(e,n){if("object"===("undefined"===typeof window?"undefined":(0,r.default)(window))&&"document"in window){t=t.split(",");var a=t[0].match(/:(.*?);/)[1],i=atob(t[1]),o=i.length,s=new Uint8Array(o);while(o--)s[o]=i.charCodeAt(o);return e((window.URL||window.webkitURL).createObjectURL(new Blob([s],{type:a})))}var u=t.match(/data\:\S+\/(\S+);/);u?u=u[1]:n(new Error("base64 error"));var l=Date.now()+"."+u;if("object"!==("undefined"===typeof plus?"undefined":(0,r.default)(plus)))if("object"===("undefined"===typeof wx?"undefined":(0,r.default)(wx))&&wx.canIUse("getFileSystemManager")){var c=wx.env.USER_DATA_PATH+"/"+l;wx.getFileSystemManager().writeFile({filePath:c,data:t.replace(/^data:\S+\/\S+;base64,/,""),encoding:"base64",success:function(){e(c)},fail:function(t){n(t)}})}else n(new Error("not support"));else{var d=new plus.nativeObj.Bitmap("bitmap"+Date.now());d.loadBase64Data(t,(function(){var t="_doc/uniapp_temp/"+l;d.save(t,{},(function(){d.clear(),e(t)}),(function(t){d.clear(),n(t)}))}),(function(t){d.clear(),n(t)}))}}))},e.pathToBase64=function(t){return new Promise((function(e,n){if("object"===("undefined"===typeof window?"undefined":(0,r.default)(window))&&"document"in window){if("function"===typeof FileReader){var a=new XMLHttpRequest;return a.open("GET",t,!0),a.responseType="blob",a.onload=function(){if(200===this.status){var t=new FileReader;t.onload=function(t){e(t.target.result)},t.onerror=n,t.readAsDataURL(this.response)}},a.onerror=n,void a.send()}var i=document.createElement("canvas"),o=i.getContext("2d"),s=new Image;return s.onload=function(){i.width=s.width,i.height=s.height,o.drawImage(s,0,0),e(i.toDataURL()),i.height=i.width=0},s.onerror=n,void(s.src=t)}"object"!==("undefined"===typeof plus?"undefined":(0,r.default)(plus))?"object"===("undefined"===typeof wx?"undefined":(0,r.default)(wx))&&wx.canIUse("getFileSystemManager")?wx.getFileSystemManager().readFile({filePath:t,encoding:"base64",success:function(t){e("data:image/png;base64,"+t.data)},fail:function(t){n(t)}}):n(new Error("not support")):plus.io.resolveLocalFileSystemURL(function(t){if(0===t.indexOf("_www")||0===t.indexOf("_doc")||0===t.indexOf("_documents")||0===t.indexOf("_downloads"))return t;if(0===t.indexOf("file://"))return t;if(0===t.indexOf("/storage/emulated/0/"))return t;if(0===t.indexOf("/")){var e=plus.io.convertAbsoluteFileSystem(t);if(e!==t)return e;t=t.substr(1)}return"_www/"+t}(t),(function(t){t.file((function(t){var a=new plus.io.FileReader;a.onload=function(t){e(t.target.result)},a.onerror=function(t){n(t)},a.readAsDataURL(t)}),(function(t){n(t)}))}),(function(t){n(t)}))}))};var r=a(n("53ca"));n("c975"),n("d3b7"),n("d9e2"),n("d401"),n("ac1f"),n("466d"),n("81b2"),n("0eb6"),n("b7ef"),n("8bd4"),n("ace4"),n("5cc6"),n("907a"),n("9a8c"),n("a975"),n("735e"),n("c1ac"),n("d139"),n("3a7b"),n("986a"),n("1d02"),n("d5d6"),n("82f8"),n("e91f"),n("60bd"),n("5f96"),n("3280"),n("3fcc"),n("ca91"),n("25a1"),n("cd26"),n("3c5d"),n("2954"),n("649e"),n("219c"),n("b39a"),n("72f7"),n("3ca3"),n("ddb0"),n("2b3d"),n("9861"),n("5319")},"131a":function(t,e,n){var a=n("23e7"),r=n("d2bb");a({target:"Object",stat:!0},{setPrototypeOf:r})},"1da1":function(t,e,n){"use strict";function a(t,e,n,a,r,i,o){try{var s=t[i](o),u=s.value}catch(l){return void n(l)}s.done?e(u):Promise.resolve(u).then(a,r)}n("7a82"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function s(t){a(o,r,i,s,u,"next",t)}function u(t){a(o,r,i,s,u,"throw",t)}s(void 0)}))}},n("d3b7")},"23dc":function(t,e,n){var a=n("d44e");a(Math,"Math",!0)},3410:function(t,e,n){var a=n("23e7"),r=n("d039"),i=n("7b0b"),o=n("e163"),s=n("e177"),u=r((function(){o(1)}));a({target:"Object",stat:!0,forced:u,sham:!s},{getPrototypeOf:function(t){return o(i(t))}})},"7bd2":function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return r})),n.d(e,"a",(function(){}));var a=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-uni-view",{staticClass:"indexContainer"},[a("v-uni-image",{staticClass:"bgImg",attrs:{src:n("d94f"),mode:"aspectFill"}}),a("v-uni-view",{staticClass:"topBox"},[a("v-uni-view",{staticClass:"title"},t._l(t.imageList,(function(e,n){return a("v-uni-view",{key:n,staticClass:"name",class:{select:e.selected},on:{click:function(n){arguments[0]=n=t.$handleEvent(n),t.itemClick(e)}}},[t._v(t._s(e.title))])})),1),a("v-uni-scroll-view",{attrs:{"scroll-x":!0,"show-scrollbar":!1}},[a("v-uni-view",{staticClass:"imageCont"},t._l(t.getImageList(),(function(e,n){return a("v-uni-image",{key:n,attrs:{src:e.src},on:{click:function(a){arguments[0]=a=t.$handleEvent(a),t.imageClick(e,n)}}})})),1)],1)],1),a("v-uni-view",{staticClass:"mainBox"},[a("v-uni-view",{staticClass:"avatarBox ",attrs:{id:"avatar-container"}},[t.avatarImage?a("v-uni-image",{staticClass:"img",attrs:{src:t.avatarImage}}):a("v-uni-image",{staticClass:"empty",attrs:{src:"/static/index/avatar.svg"}}),t.currentFrame?a("v-uni-image",{staticClass:"avatarBg",attrs:{src:t.currentFrame}}):t._e()],1),a("v-uni-view",{staticClass:"btnBox"},[a("v-uni-view",{staticClass:"iconBtn"},[t.showSwitch(-1)?a("v-uni-view",{staticClass:"icon-zuo iconfont",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.switchAvatar(-1)}}}):t._e(),t.showSwitch(1)?a("v-uni-view",{staticClass:"icon-you iconfont",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.switchAvatar(1)}}}):t._e()],1),a("v-uni-button",{staticClass:"actionBtn",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.uploadFace()}}},[t._v("上传头像")]),a("v-uni-button",{staticClass:"actionBtn save",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.saveFace()}}},[t._v("保存头像")])],1)],1),a("v-uni-view",{staticClass:"hideCanvasView"},[a("v-uni-canvas",{staticClass:"hideCanvas",style:{width:(t.poster.width||10)+"px",height:(t.poster.height||10)+"px"},attrs:{id:t.canvasId,"canvas-id":t.canvasId}})],1)],1)},r=[]},9308:function(t,e,n){(function(e){var a=n("7037").default;n("d3b7"),n("e9c4"),n("c740");e.log;var r={lineFeedTags:["<br />","<br/>","\r\n","\n\t","\r","\n"],tagetLineFeedTag:"❤",log:function(t){},showLoading:function(t,e){uni.showLoading({title:t,mask:e||!1})},hideLoading:function(){uni.hideLoading()},showToast:function(t,e){uni.showToast({title:t,icon:e||"none"})},getPosterUrl:function(t){var e=t.backgroundImage,n=t.type;t.formData;return new Promise((function(t,a){var r;if(e)r=e;else switch(n){case 1:r="";break;default:r="/static/1.png";break}r?t(r):a("背景图片路径不存在")}))},shareTypeListSheetArray:{array:[0,1,2,3,4,5]},isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},isObject:function(t){return"[object Object]"===Object.prototype.toString.call(t)},isPromise:function(t){return!!t&&("object"===a(t)||"function"===typeof t)&&"function"===typeof t.then},isNull:function(t){return null===t},isUndefined:function(t){return void 0===t},isUndef:function(t){return void 0===t},isNotNull_string:function(t){return null!==t&&void 0!==t&&""!==t},isFn:function(t){return t&&"function"===typeof t},getStorage:function(t,e,n){uni.getStorage({key:t,success:function(t){t.data&&""!=t.data?e&&e(t.data):n&&n()},fail:function(){n&&n()}})},setStorage:function(t,e){JSON.stringify(e),uni.setStorage({key:t,data:e})},setStorageSync:function(t,e){uni.setStorageSync(t,e)},getStorageSync:function(t){return uni.getStorageSync(t)},clearStorageSync:function(){uni.clearStorageSync()},removeStorageSync:function(t){uni.removeStorageSync(t)},getImageInfo:function(t,e,n){t=i(t),wx.getImageInfo({src:t,success:function(t){e&&"function"==typeof e&&e(t)},fail:function(t){n&&"function"==typeof n&&n(t)}})},downloadFile:function(t,e){t=i(t),wx.downloadFile({url:t,success:function(t){e&&"function"==typeof e&&e(t)}})},downloadFile_PromiseFc:function(t){return new Promise((function(e,n){"http"!==t.substring(0,4)?e(t):(t=i(t),wx.downloadFile({url:t,success:function(t){t&&t.tempFilePath?e(t.tempFilePath):n("not find tempFilePath")},fail:function(t){n(t)}}))}))},saveFile:function(t){uni.saveFile({tempFilePath:t,success:function(t){JSON.stringify(t)}})},downLoadAndSaveFile_PromiseFc:function(t){return new Promise((function(e,n){"http"===t.substring(0,4)?(t=i(t),uni.downloadFile({url:t,success:function(t){JSON.stringify(t),t&&t.tempFilePath?e(t.tempFilePath):n("not find tempFilePath")},fail:function(t){n(t)}})):e(t)}))},checkFile_PromiseFc:function(t){return new Promise((function(e,n){uni.getSavedFileList({success:function(n){var a=n.fileList,r=a.findIndex((function(e){return e.filePath===t}));e(r)},fail:function(t){n(t)}})}))},removeSavedFile:function(t){uni.getSavedFileList({success:function(e){var n=e.fileList,a=n.findIndex((function(e){return e.filePath===t}));a>=0&&uni.removeSavedFile({filePath:t})}})},fileNameInPath:function(t){var e=t.split("/");return e[e.length-1]},getImageInfo_PromiseFc:function(t){return new Promise((function(e,n){t=i(t),wx.getImageInfo({src:t,success:function(t){JSON.stringify(t),e(t)},fail:function(t){JSON.stringify(t),n(t)}})}))},previewImage:function(t){"string"==typeof t&&(t=[t]),uni.previewImage({urls:t})},actionSheet:function(t,e){for(var n=[],a=0;a<t.array.length;a++)switch(t.array[a]){case"sinaweibo":n[a]="新浪微博";break;case"qq":n[a]="QQ";break;case"weixin":n[a]="微信";break;case"WXSceneSession":n[a]="微信好友";break;case"WXSenceTimeline":n[a]="微信朋友圈";break;case"WXSceneFavorite":n[a]="微信收藏";break;case 0:n[a]="图文链接";break;case 1:n[a]="纯文字";break;case 2:n[a]="纯图片";break;case 3:n[a]="音乐";break;case 4:n[a]="视频";break;case 5:n[a]="小程序";break;default:break}this.showActionSheet(n,e)},showActionSheet:function(t,e){uni.showActionSheet({itemList:t,success:function(t){e&&"function"==typeof e&&e(t.tapIndex)}})},getProvider:function(t,e,n){var a=this;uni.getProvider({service:t,success:function(r){if(n){var i={};i.array=r.provider,a.actionSheet(i,(function(t){e&&"function"==typeof e&&e(r.provider[t])}))}else if("payment"==t){for(var o=r.provider,s=[],u=0;u<o.length;u++)"wxpay"==o[u]?s[u]={name:"微信支付",value:o[u],img:"/static/image/wei.png"}:"alipay"==o[u]&&(s[u]={name:"支付宝支付",value:o[u],img:"/static/image/ali.png"});e&&"function"==typeof e&&e(s)}else e&&"function"==typeof e&&e(r)}})}};function i(t){return t}t.exports=r}).call(this,n("5a52")["default"])},"944a":function(t,e,n){var a=n("d066"),r=n("e065"),i=n("d44e");r("toStringTag"),i(a("Symbol"),"Symbol")},a21d:function(t,e,n){"use strict";n.r(e);var a=n("e958"),r=n.n(a);for(var i in a)["default"].indexOf(i)<0&&function(t){n.d(e,t,(function(){return a[t]}))}(i);e["default"]=r.a},b27d:function(t,e,n){var a=n("d14c");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var r=n("4f06").default;r("325d999d",a,!0,{sourceMap:!1,shadowMode:!1})},b636:function(t,e,n){var a=n("e065");a("asyncIterator")},c7eb:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */
e.default=function(){return t};var t={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",u=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(A){c=function(t,e,n){return t[e]=n}}function d(t,e,n,a){var r=e&&e.prototype instanceof g?e:g,o=Object.create(r.prototype),s=new I(a||[]);return i(o,"_invoke",{value:P(t,n,s)}),o}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(A){return{type:"throw",arg:A}}}t.wrap=d;var h={};function g(){}function m(){}function p(){}var v={};c(v,s,(function(){return this}));var b=Object.getPrototypeOf,y=b&&b(b(L([])));y&&y!==n&&r.call(y,s)&&(v=y);var x=p.prototype=g.prototype=Object.create(v);function w(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){var n;i(this,"_invoke",{value:function(i,o){function s(){return new e((function(n,s){(function n(i,o,s,u){var l=f(t[i],t,o);if("throw"!==l.type){var c=l.arg,d=c.value;return d&&"object"==(0,a.default)(d)&&r.call(d,"__await")?e.resolve(d.__await).then((function(t){n("next",t,s,u)}),(function(t){n("throw",t,s,u)})):e.resolve(d).then((function(t){c.value=t,s(c)}),(function(t){return n("throw",t,s,u)}))}u(l.arg)})(i,o,n,s)}))}return n=n?n.then(s,s):s()}})}function P(t,e,n){var a="suspendedStart";return function(r,i){if("executing"===a)throw new Error("Generator is already running");if("completed"===a){if("throw"===r)throw i;return C()}for(n.method=r,n.arg=i;;){var o=n.delegate;if(o){var s=N(o,n);if(s){if(s===h)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===a)throw a="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);a="executing";var u=f(t,e,n);if("normal"===u.type){if(a=n.done?"completed":"suspendedYield",u.arg===h)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(a="completed",n.method="throw",n.arg=u.arg)}}}function N(t,e){var n=e.method,a=t.iterator[n];if(void 0===a)return e.delegate=null,"throw"===n&&t.iterator["return"]&&(e.method="return",e.arg=void 0,N(t,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var r=f(a,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,h;var i=r.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function L(t){if(t){var e=t[s];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,a=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return a.next=a}}return{next:C}}function C(){return{value:void 0,done:!0}}return m.prototype=p,i(x,"constructor",{value:p,configurable:!0}),i(p,"constructor",{value:m,configurable:!0}),m.displayName=c(p,l,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,c(t,l,"GeneratorFunction")),t.prototype=Object.create(x),t},t.awrap=function(t){return{__await:t}},w(k.prototype),c(k.prototype,u,(function(){return this})),t.AsyncIterator=k,t.async=function(e,n,a,r,i){void 0===i&&(i=Promise);var o=new k(d(e,n,a,r),i);return t.isGeneratorFunction(n)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},w(x),c(x,l,"Generator"),c(x,s,(function(){return this})),c(x,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),n=[];for(var a in e)n.push(a);return n.reverse(),function t(){for(;n.length;){var a=n.pop();if(a in e)return t.value=a,t.done=!1,t}return t.done=!0,t}},t.values=L,I.prototype={constructor:I,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(n,a){return o.type="throw",o.arg=t,e.next=n,a&&(e.method="next",e.arg=void 0),!!a}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],o=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var s=r.call(i,"catchLoc"),u=r.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var i=a;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=t,o.arg=e,i?(this.method="next",this.next=i.finallyLoc,h):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var a=n.completion;if("throw"===a.type){var r=a.arg;T(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:L(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),h}},t},n("7a82"),n("a4d3"),n("e01a"),n("d3b7"),n("d28b"),n("3ca3"),n("ddb0"),n("b636"),n("944a"),n("0c47"),n("23dc"),n("3410"),n("d9e2"),n("d401"),n("14d9"),n("159b"),n("131a"),n("26e9"),n("fb6a");var a=function(t){return t&&t.__esModule?t:{default:t}}(n("53ca"))},cb29:function(t,e,n){var a=n("23e7"),r=n("81d5"),i=n("44d2");a({target:"Array",proto:!0},{fill:r}),i("fill")},d14c:function(t,e,n){var a=n("24fb");e=a(!1),e.push([t.i,".indexContainer[data-v-a4d60abc]{height:100vh;padding-top:%?200?%;box-sizing:border-box;overflow:hidden}.indexContainer .bgImg[data-v-a4d60abc]{position:absolute;z-index:-1;top:0;left:0;right:0;bottom:0;height:100vh;width:100%;background-color:#ffd48f}.indexContainer .topBox[data-v-a4d60abc]{background-color:#fff;margin:0 %?30?%;border-radius:%?40?%;padding:%?40?% %?45?% %?40?%;position:relative}.indexContainer .topBox .title[data-v-a4d60abc]{display:flex;align-items:center;justify-content:space-evenly;padding:0 0 %?40?%}.indexContainer .topBox .title .name[data-v-a4d60abc]{flex:1;font-size:%?30?%;text-align:center}.indexContainer .topBox .title .select[data-v-a4d60abc]{font-weight:700;color:#ff4500}.indexContainer .topBox .imageCont[data-v-a4d60abc]{display:flex;align-items:center}.indexContainer .topBox .imageCont uni-image[data-v-a4d60abc]{width:%?120?%;height:%?120?%;flex-shrink:0;margin:0 %?15?%}.indexContainer .topBox .imageCont uni-image[data-v-a4d60abc]:last-child{padding-right:%?15?%}.indexContainer .mainBox[data-v-a4d60abc]{display:flex;justify-content:center;justify-content:space-between;margin:%?60?% %?30?% 0}.indexContainer .mainBox .avatarBox[data-v-a4d60abc]{position:relative;height:%?380?%;width:%?380?%;margin-right:%?40?%;display:flex;align-items:center;justify-content:center;flex-direction:column;background-color:#fff;border-radius:%?40?%;overflow:hidden}.indexContainer .mainBox .avatarBox .img[data-v-a4d60abc]{height:100%;width:100%}.indexContainer .mainBox .avatarBox .empty[data-v-a4d60abc]{height:100px;width:100px}.indexContainer .mainBox .avatarBox .avatarBg[data-v-a4d60abc]{position:absolute;left:0;top:0;z-index:10;height:100%;width:100%}.indexContainer .mainBox .btnBox[data-v-a4d60abc]{display:flex;flex-direction:column;justify-content:space-between;padding:%?10?% 0}.indexContainer .mainBox .btnBox .iconBtn[data-v-a4d60abc]{position:relative;height:%?80?%}.indexContainer .mainBox .btnBox .iconBtn .iconfont[data-v-a4d60abc]{color:#f7f8fa;font-size:%?80?%;font-weight:700}.indexContainer .mainBox .btnBox .iconBtn .icon-zuo[data-v-a4d60abc]{position:absolute;left:0}.indexContainer .mainBox .btnBox .iconBtn .icon-you[data-v-a4d60abc]{position:absolute;right:0}.indexContainer .mainBox .btnBox .actionBtn[data-v-a4d60abc]{background:#fff;border:none;border-radius:%?48?%;box-shadow:0 %?12?% %?16?% %?-8?% rgba(0,0,0,.1);color:#4d4d4d;font-weight:bolder;height:%?90?%;line-height:%?90?%;font-size:%?30?%;padding:0 %?60?%}.indexContainer .mainBox .btnBox .actionBtn[data-v-a4d60abc]::after{border:none}.indexContainer .mainBox .btnBox .actionBtn.save[data-v-a4d60abc]{background:linear-gradient(97.71deg,#ffa462,#ff4d42 88.36%);border-radius:%?48?%;box-shadow:0 %?12?% %?16?% %?-8?% rgba(255,88,35,.6);color:#fff}.hideCanvasView[data-v-a4d60abc]{position:relative}.hideCanvasView .hideCanvas[data-v-a4d60abc]{position:fixed;top:%?-9999?%;left:%?-9999?%;z-index:-9999}",""]),t.exports=e},d94f:function(t,e,n){t.exports=n.p+"static/img/background.fcec52c5.jpg"},ddd4:function(t,e,n){"use strict";var a=n("b27d"),r=n.n(a);r.a},e958:function(t,e,n){"use strict";(function(t){n("7a82");var a=n("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=a(n("c7eb")),i=a(n("1da1"));n("c740"),n("4de4"),n("d3b7"),n("159b"),n("e9c4"),n("caad"),n("2532");var o=n("fd01"),s={data:function(){return{poster:{},posterImage:"",canvasId:"defaultCanvasId",userInfo:"",code:"",readLocal:!0,avatarImage:"",currentFrame:"/static/images/gradual/1.png",currentIndex:0,imageList:[{title:"渐变国旗",selected:!0,imgs:[{src:"/static/images/gradual/1.png"},{src:"/static/images/gradual/2.png"},{src:"/static/images/gradual/3.png"},{src:"/static/images/gradual/4.png"},{src:"/static/images/gradual/5.png"},{src:"/static/images/gradual/6.png"}]},{title:"多样背景",selected:!1,imgs:[{src:"/static/images/other/1.png"},{src:"/static/images/other/2.png"},{src:"/static/images/other/3.png"},{src:"/static/images/other/4.png"},{src:"/static/images/other/5.png"},{src:"/static/images/other/6.png"},{src:"/static/images/other/7.png"},{src:"/static/images/other/8.png"},{src:"/static/images/other/9.png"},{src:"/static/images/other/10.png"}]},{title:"质朴国旗",selected:!1,imgs:[{src:"/static/images/simple/1.png"},{src:"/static/images/simple/2.png"},{src:"/static/images/simple/3.png"},{src:"/static/images/simple/4.png"},{src:"/static/images/simple/5.png"},{src:"/static/images/simple/6.png"},{src:"/static/images/simple/7.png"}]},{title:"国庆新款",selected:!1,imgs:[{src:"/static/images/new/1.png"},{src:"/static/images/new/2.png"},{src:"/static/images/new/3.png"}]}]}},onLoad:function(){this.readLocal&&(this.userInfo=uni.getStorageSync("user_info"),this.avatarImage=this.userInfo.avatarUrl)},onShareAppMessage:function(){return{title:"我刚刚换上了国庆头像，你也来领取一个吧",desc:"领取你的国庆头像，为祖国加油",imageUrl:"/static/index/share.jpg",path:"/pages/index/index",success:function(e){t.log(e)}}},onShareTimeline:function(){return{title:"我刚刚换上了国庆头像，你也来领取一个吧",desc:"领取你的国庆头像，为祖国加油",imageUrl:"/static/index/share.jpg",path:"/pages/index/index",success:function(e){t.log(e)}}},methods:{switchAvatar:function(t){if(t>0&&this.currentIndex<this.getImageList().length-1||t<0&&this.currentIndex>0)this.currentIndex+=t,this.currentFrame=this.getImageList()[this.currentIndex].src;else{var e=this.imageList.findIndex((function(t){return t.selected}));e+=t,e>=0&&e<this.imageList.length&&(this.itemClick(this.imageList[e]),this.currentIndex=t<0?this.getImageList().length-1:0,this.currentFrame=this.getImageList()[0].src)}},showSwitch:function(t){var e=this.imageList.findIndex((function(t){return t.selected})),n=t<0&&e<=0&&this.currentIndex<=0||t>0&&e>=this.imageList.length-1&&this.currentIndex>=this.getImageList().length-1;return!n},imageClick:function(t,e){this.currentIndex=e,this.currentFrame=t.src},getImageList:function(){var t=this.imageList.filter((function(t){return t.selected}));return t[0].imgs},itemClick:function(t){this.currentIndex=0,this.imageList.forEach((function(t){t.selected=!1})),t.selected=!0},uploadFace:function(){var t=this,e={quality:100,width:600,height:600,resize:!0};uni.chooseImage({count:1,crop:e,sourceType:["album"],success:function(){var n=(0,i.default)((0,r.default)().mark((function n(a){var i;return(0,r.default)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(a.tempFiles[0].size,!(a.tempFiles[0].size/1024/1024>2)){n.next=5;break}uni.showToast({title:"图片大小不能大于2M",icon:"none",mask:!0}),n.next=10;break;case 5:return i=a.tempFilePaths[0],n.next=8,new Promise((function(t){uni.navigateTo({url:"/pages/index/cropImage?path="+i+"&options=".concat(JSON.stringify(e)),animationType:"fade-in",events:{success:function(e){t(e)}}})}));case 8:i=n.sent,t.avatarImage=i;case 10:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}()})},onChooseAvatar:function(t){var e=t.detail.avatarUrl,n={avatarUrl:e};this.avatarImage=e,uni.setStorageSync("user_info",n)},saveFace:function(){var t=this;return(0,i.default)((0,r.default)().mark((function e(){var n;return(0,r.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.avatarImage){e.next=3;break}return uni.showToast({title:"请先上传头像",icon:"error",mask:!0}),e.abrupt("return");case 3:return e.prev=3,uni.showLoading({title:"图片生成中..",mask:!0}),e.next=7,(0,o.getSharePoster)({that:t,type:"testShareType",formData:{},backgroundImage:t.avatarImage,posterCanvasId:t.canvasId,delayTimeScale:20,drawArray:function(e){var n=e.bgObj;e.type,e.bgScale;return new Promise((function(e,a){e([{type:"image",url:t.currentFrame,dx:0,dy:0,infoCallBack:function(t){return{dWidth:n.width,dHeight:n.height}}}])}))},setCanvasWH:function(e){var n=e.bgObj;e.type,e.bgScale;t.poster=n}});case 7:n=e.sent,t.posterImage=n.poster.tempFilePath,uni.hideLoading(),uni.previewImage({urls:[t.posterImage]}),e.next=16;break;case 13:e.prev=13,e.t0=e["catch"](3),uni.hideLoading();case 16:case"end":return e.stop()}}),e,null,[[3,13]])})))()},savefile:function(){var t=this;uni.getSetting({success:function(e){e.authSetting["scope.writePhotosAlbum"]?t.saveImgToLocal():uni.authorize({scope:"scope.writePhotosAlbum",success:function(){t.saveImgToLocal()},fail:function(t){uni.hideLoading(),wx.showModal({content:"检测到您没打开下载图片功能权限，是否去设置打开？",confirmText:"确认",cancelText:"取消",success:function(t){t.confirm&&wx.openSetting()}})}})}})},saveImgToLocal:function(t){uni.saveImageToPhotosAlbum({filePath:this.posterImage,success:function(){uni.hideLoading(),uni.showToast({title:"保存成功",icon:"success"})},fail:function(t){uni.hideLoading(),uni.showToast({title:t.errMsg.includes("cancel")?"用户取消":"保存失败",icon:"error"})}})}}};e.default=s}).call(this,n("5a52")["default"])},f67b:function(t,e,n){"use strict";function a(t){var e,n,a;return t<128?[t]:t<2048?(e=192+(t>>6),n=128+(63&t),[e,n]):(e=224+(t>>12),n=128+(t>>6&63),a=128+(63&t),[e,n,a])}function r(t,e){this.typeNumber=-1,this.errorCorrectLevel=e,this.modules=null,this.moduleCount=0,this.dataCache=null,this.rsBlocks=null,this.totalDataCount=-1,this.data=t,this.utf8bytes=function(t){for(var e=[],n=0;n<t.length;n++)for(var r=t.charCodeAt(n),i=a(r),o=0;o<i.length;o++)e.push(i[o]);return e}(t),this.make()}n("7a82"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=r,n("14d9"),n("d9e2"),n("d401"),r.prototype={constructor:r,getModuleCount:function(){return this.moduleCount},make:function(){this.getRightType(),this.dataCache=this.createData(),this.createQrcode()},makeImpl:function(t){this.moduleCount=4*this.typeNumber+17,this.modules=new Array(this.moduleCount);for(var e=0;e<this.moduleCount;e++)this.modules[e]=new Array(this.moduleCount);this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(!0,t),this.typeNumber>=7&&this.setupTypeNumber(!0),this.mapData(this.dataCache,t)},setupPositionProbePattern:function(t,e){for(var n=-1;n<=7;n++)if(!(t+n<=-1||this.moduleCount<=t+n))for(var a=-1;a<=7;a++)e+a<=-1||this.moduleCount<=e+a||(this.modules[t+n][e+a]=0<=n&&n<=6&&(0==a||6==a)||0<=a&&a<=6&&(0==n||6==n)||2<=n&&n<=4&&2<=a&&a<=4)},createQrcode:function(){for(var t=0,e=0,n=null,a=0;a<8;a++){this.makeImpl(a);var r=s.getLostPoint(this);(0==a||t>r)&&(t=r,e=a,n=this.modules)}this.modules=n,this.setupTypeInfo(!1,e),this.typeNumber>=7&&this.setupTypeNumber(!1)},setupTimingPattern:function(){for(var t=8;t<this.moduleCount-8;t++)null==this.modules[t][6]&&(this.modules[t][6]=t%2==0,null==this.modules[6][t]&&(this.modules[6][t]=t%2==0))},setupPositionAdjustPattern:function(){for(var t=s.getPatternPosition(this.typeNumber),e=0;e<t.length;e++)for(var n=0;n<t.length;n++){var a=t[e],r=t[n];if(null==this.modules[a][r])for(var i=-2;i<=2;i++)for(var o=-2;o<=2;o++)this.modules[a+i][r+o]=-2==i||2==i||-2==o||2==o||0==i&&0==o}},setupTypeNumber:function(t){for(var e=s.getBCHTypeNumber(this.typeNumber),n=0;n<18;n++){var a=!t&&1==(e>>n&1);this.modules[Math.floor(n/3)][n%3+this.moduleCount-8-3]=a,this.modules[n%3+this.moduleCount-8-3][Math.floor(n/3)]=a}},setupTypeInfo:function(t,e){for(var n=i[this.errorCorrectLevel]<<3|e,a=s.getBCHTypeInfo(n),r=0;r<15;r++){var o=!t&&1==(a>>r&1);r<6?this.modules[r][8]=o:r<8?this.modules[r+1][8]=o:this.modules[this.moduleCount-15+r][8]=o;o=!t&&1==(a>>r&1);r<8?this.modules[8][this.moduleCount-r-1]=o:r<9?this.modules[8][15-r-1+1]=o:this.modules[8][15-r-1]=o}this.modules[this.moduleCount-8][8]=!t},createData:function(){var t=new f,e=this.typeNumber>9?16:8;t.put(4,4),t.put(this.utf8bytes.length,e);for(var n=0,a=this.utf8bytes.length;n<a;n++)t.put(this.utf8bytes[n],8);t.length+4<=8*this.totalDataCount&&t.put(0,4);while(t.length%8!=0)t.putBit(!1);while(1){if(t.length>=8*this.totalDataCount)break;if(t.put(r.PAD0,8),t.length>=8*this.totalDataCount)break;t.put(r.PAD1,8)}return this.createBytes(t)},createBytes:function(t){for(var e=0,n=0,a=0,r=this.rsBlock.length/3,i=new Array,o=0;o<r;o++)for(var u=this.rsBlock[3*o+0],l=this.rsBlock[3*o+1],d=this.rsBlock[3*o+2],f=0;f<u;f++)i.push([d,l]);for(var h=new Array(i.length),g=new Array(i.length),m=0;m<i.length;m++){var p=i[m][0],v=i[m][1]-p;n=Math.max(n,p),a=Math.max(a,v),h[m]=new Array(p);for(o=0;o<h[m].length;o++)h[m][o]=255&t.buffer[o+e];e+=p;var b=s.getErrorCorrectPolynomial(v),y=new c(h[m],b.getLength()-1),x=y.mod(b);g[m]=new Array(b.getLength()-1);for(o=0;o<g[m].length;o++){var w=o+x.getLength()-g[m].length;g[m][o]=w>=0?x.get(w):0}}var k=new Array(this.totalDataCount),P=0;for(o=0;o<n;o++)for(m=0;m<i.length;m++)o<h[m].length&&(k[P++]=h[m][o]);for(o=0;o<a;o++)for(m=0;m<i.length;m++)o<g[m].length&&(k[P++]=g[m][o]);return k},mapData:function(t,e){for(var n=-1,a=this.moduleCount-1,r=7,i=0,o=this.moduleCount-1;o>0;o-=2){6==o&&o--;while(1){for(var u=0;u<2;u++)if(null==this.modules[a][o-u]){var l=!1;i<t.length&&(l=1==(t[i]>>>r&1));var c=s.getMask(e,a,o-u);c&&(l=!l),this.modules[a][o-u]=l,r--,-1==r&&(i++,r=7)}if(a+=n,a<0||this.moduleCount<=a){a-=n,n=-n;break}}}}},r.PAD0=236,r.PAD1=17;for(var i=[1,0,3,2],o={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7},s={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(t){var e=t<<10;while(s.getBCHDigit(e)-s.getBCHDigit(s.G15)>=0)e^=s.G15<<s.getBCHDigit(e)-s.getBCHDigit(s.G15);return(t<<10|e)^s.G15_MASK},getBCHTypeNumber:function(t){var e=t<<12;while(s.getBCHDigit(e)-s.getBCHDigit(s.G18)>=0)e^=s.G18<<s.getBCHDigit(e)-s.getBCHDigit(s.G18);return t<<12|e},getBCHDigit:function(t){var e=0;while(0!=t)e++,t>>>=1;return e},getPatternPosition:function(t){return s.PATTERN_POSITION_TABLE[t-1]},getMask:function(t,e,n){switch(t){case o.PATTERN000:return(e+n)%2==0;case o.PATTERN001:return e%2==0;case o.PATTERN010:return n%3==0;case o.PATTERN011:return(e+n)%3==0;case o.PATTERN100:return(Math.floor(e/2)+Math.floor(n/3))%2==0;case o.PATTERN101:return e*n%2+e*n%3==0;case o.PATTERN110:return(e*n%2+e*n%3)%2==0;case o.PATTERN111:return(e*n%3+(e+n)%2)%2==0;default:throw new Error("bad maskPattern:"+t)}},getErrorCorrectPolynomial:function(t){for(var e=new c([1],0),n=0;n<t;n++)e=e.multiply(new c([1,u.gexp(n)],0));return e},getLostPoint:function(t){for(var e=t.getModuleCount(),n=0,a=0,r=0;r<e;r++)for(var i=0,o=t.modules[r][0],s=0;s<e;s++){var u=t.modules[r][s];if(s<e-6&&u&&!t.modules[r][s+1]&&t.modules[r][s+2]&&t.modules[r][s+3]&&t.modules[r][s+4]&&!t.modules[r][s+5]&&t.modules[r][s+6]&&(s<e-10?t.modules[r][s+7]&&t.modules[r][s+8]&&t.modules[r][s+9]&&t.modules[r][s+10]&&(n+=40):s>3&&t.modules[r][s-1]&&t.modules[r][s-2]&&t.modules[r][s-3]&&t.modules[r][s-4]&&(n+=40)),r<e-1&&s<e-1){var l=0;u&&l++,t.modules[r+1][s]&&l++,t.modules[r][s+1]&&l++,t.modules[r+1][s+1]&&l++,0!=l&&4!=l||(n+=3)}o^u?i++:(o=u,i>=5&&(n+=3+i-5),i=1),u&&a++}for(s=0;s<e;s++)for(i=0,o=t.modules[0][s],r=0;r<e;r++){u=t.modules[r][s];r<e-6&&u&&!t.modules[r+1][s]&&t.modules[r+2][s]&&t.modules[r+3][s]&&t.modules[r+4][s]&&!t.modules[r+5][s]&&t.modules[r+6][s]&&(r<e-10?t.modules[r+7][s]&&t.modules[r+8][s]&&t.modules[r+9][s]&&t.modules[r+10][s]&&(n+=40):r>3&&t.modules[r-1][s]&&t.modules[r-2][s]&&t.modules[r-3][s]&&t.modules[r-4][s]&&(n+=40)),o^u?i++:(o=u,i>=5&&(n+=3+i-5),i=1)}var c=Math.abs(100*a/e/e-50)/5;return n+=10*c,n}},u={glog:function(t){if(t<1)throw new Error("glog("+t+")");return u.LOG_TABLE[t]},gexp:function(t){while(t<0)t+=255;while(t>=256)t-=255;return u.EXP_TABLE[t]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)},l=0;l<8;l++)u.EXP_TABLE[l]=1<<l;for(l=8;l<256;l++)u.EXP_TABLE[l]=u.EXP_TABLE[l-4]^u.EXP_TABLE[l-5]^u.EXP_TABLE[l-6]^u.EXP_TABLE[l-8];for(l=0;l<255;l++)u.LOG_TABLE[u.EXP_TABLE[l]]=l;function c(t,e){if(void 0==t.length)throw new Error(t.length+"/"+e);var n=0;while(n<t.length&&0==t[n])n++;this.num=new Array(t.length-n+e);for(var a=0;a<t.length-n;a++)this.num[a]=t[a+n]}c.prototype={get:function(t){return this.num[t]},getLength:function(){return this.num.length},multiply:function(t){for(var e=new Array(this.getLength()+t.getLength()-1),n=0;n<this.getLength();n++)for(var a=0;a<t.getLength();a++)e[n+a]^=u.gexp(u.glog(this.get(n))+u.glog(t.get(a)));return new c(e,0)},mod:function(t){var e=this.getLength(),n=t.getLength();if(e-n<0)return this;for(var a=new Array(e),r=0;r<e;r++)a[r]=this.get(r);while(a.length>=n){var i=u.glog(a[0])-u.glog(t.get(0));for(r=0;r<t.getLength();r++)a[r]^=u.gexp(u.glog(t.get(r))+i);while(0==a[0])a.shift()}return new c(a,0)}};var d=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]];function f(){this.buffer=new Array,this.length=0}r.prototype.getRightType=function(){for(var t=1;t<41;t++){var e=d[4*(t-1)+this.errorCorrectLevel];if(void 0==e)throw new Error("bad rs block @ typeNumber:"+t+"/errorCorrectLevel:"+this.errorCorrectLevel);for(var n=e.length/3,a=0,r=0;r<n;r++){var i=e[3*r+0],o=e[3*r+2];a+=o*i}var s=t>9?2:1;if(this.utf8bytes.length+s<a||40==t){this.typeNumber=t,this.rsBlock=e,this.totalDataCount=a;break}}},f.prototype={get:function(t){var e=Math.floor(t/8);return this.buffer[e]>>>7-t%8&1},put:function(t,e){for(var n=0;n<e;n++)this.putBit(t>>>e-n-1&1)},putBit:function(t){var e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),t&&(this.buffer[e]|=128>>>this.length%8),this.length++}}},fd01:function(t,e,n){"use strict";var a=n("4ea4").default,r=a(n("53ca")),i=a(n("c7eb")),o=a(n("2909")),s=a(n("5530")),u=a(n("1da1"));n("d3b7"),n("e9c4"),n("4e82"),n("a9e3"),n("3ca3"),n("ddb0"),n("c740"),n("159b"),n("a434"),n("99af"),n("cb29"),n("ac1f"),n("1276"),n("14d9"),n("00b4"),n("498a"),n("caad"),n("2532");var l=a(n("9308")),c=a(n("f67b")),d=n("120f"),f="QSSHAREPOSTER_IDKEY";function h(t){var e=t.Context,n=t.type,a=t.posterCanvasId,r=t.reserve,i=t.bgObj,o=t.drawArray,u=t.textArray,c=t.qrCodeArray,d=t.imagesArray,f=t.setCanvasToTempFilePath,h=t.setDraw,b=t.bgScale,y=t._this,x=t.delayTimeScale,w=t.drawDelayTime,k=t.canvas2image,P=t.draw,N={Context:e,bgObj:i,type:n,bgScale:b};return x=void 0!==x?x:15,w=void 0!==w?w:100,new Promise((function(t,b){try{if(l.default.showLoading("正在绘制海报"),l.default.log("背景对象:"+JSON.stringify(i)),i&&i.path?(l.default.log("背景有图片路径"),e.drawImage(i.path,0,0,i.width,i.height)):(l.default.log("背景没有图片路径"),i.backgroundColor?(l.default.log("背景有背景颜色:"+i.backgroundColor),e.setFillStyle(i.backgroundColor),e.fillRect(0,0,i.width,i.height)):l.default.log("背景没有背景颜色")),l.default.showLoading("绘制图片"),d&&d.length>0&&L(e,d),l.default.showLoading("绘制自定义内容"),h&&"function"==typeof h&&h(N),l.default.showLoading("绘制文本"),u&&u.length>0&&T(e,u,i),l.default.showLoading("绘制二维码"),c&&c.length>0)for(var S=0;S<c.length;S++)O(e,c[S]);if(l.default.showLoading("绘制可控层级序列"),o&&o.length>0)for(var I=0;I<o.length;I++){var C=o[I];switch(l.default.log("绘制可控层级序列, drawArrayItem:"+JSON.stringify(C)),C.type){case"image":l.default.log("绘制可控层级序列, 绘制图片"),L(e,C);break;case"text":l.default.log("绘制可控层级序列, 绘制文本"),T(e,C,i);break;case"qrcode":l.default.log("绘制可控层级序列, 绘制二维码"),O(e,C);break;case"custom":l.default.log("绘制可控层级序列, 绘制自定义内容"),C.setDraw&&"function"===typeof C.setDraw&&C.setDraw(e);break;case"fillRect":l.default.log("绘制可控层级序列, 绘制填充直角矩形"),g(e,C);break;case"strokeRect":l.default.log("绘制可控层级序列, 绘制线条直角矩形"),m(e,C);break;case"roundStrokeRect":l.default.log("绘制可控层级序列, 绘制线条圆角矩形"),p(e,C);break;case"roundFillRect":l.default.log("绘制可控层级序列, 绘制填充圆角矩形"),v(e,C);break;default:l.default.log("未识别的类型");break}}if(l.default.showLoading("绘制中"),l.default.log("准备执行draw方法"),l.default.log("Context:",e),!1===P)return l.default.log("draw属性为false，请自行调用canvas实例的draw方法"),void t();e.draw("boolean"==typeof r&&r,setTimeout((function(){var e,r=f||{};r&&"function"==typeof r&&(r=f(i,n));uni.getSystemInfoSync().pixelRatio;var h=(0,s.default)((0,s.default)({quality:1,fileType:"jpg"},r),{},{canvasId:a});if(!1===k)return l.default.hideLoading(),t({setCanvasToTempFilePath:h});l.default.showLoading("正在输出图片"),l.default.log("canvasToTempFilePath的data对象:"+JSON.stringify(h)),e=function(){var e=(0,s.default)((0,s.default)({},h),{},{success:function(e){l.default.hideLoading(),t((0,s.default)((0,s.default)({},e),{},{setCanvasToTempFilePath:h}))},fail:function(t){l.default.hideLoading(),l.default.log("输出图片失败"),l.default.log("输出图片失败:"+JSON.stringify(t)),b("输出图片失败:"+JSON.stringify(t))}});uni.canvasToTempFilePath(e,y||null)};var g=0;c&&c.forEach((function(t){t.text&&(g+=Number(t.text.length))})),d&&d.forEach((function(){g+=x})),u&&u.forEach((function(){g+=x})),o&&o.forEach((function(t){switch(t.type){case"text":t.text&&(g+=t.text.length);break;case"qrcode":t.text&&(g+=2*t.text.length);break;default:g+=x;break}})),l.default.log("延时系数:"+x),l.default.log("总计延时:"+g),setTimeout(e,g)}),w))}catch(A){l.default.hideLoading(),b(A)}}))}function g(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};l.default.log("进入绘制填充直角矩形方法, drawArrayItem:"+JSON.stringify(e)),t.setFillStyle(e.backgroundColor||"black"),t.setGlobalAlpha(e.alpha||1),t.fillRect(e.dx||0,e.dy||0,e.width||0,e.height||0),t.setGlobalAlpha(1)}function m(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.setStrokeStyle(e.color||"black"),t.setLineWidth(e.lineWidth||1),t.strokeRect(e.dx,e.dy,e.width,e.height)}function p(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.dx,a=e.dy,r=e.width,i=e.height,o=e.r,s=e.lineWidth,u=e.color;o=o||.1*r,r<2*o&&(o=r/2),r<2*o&&(o=r/2),t.beginPath(),t.arc(n+o,a+o,o,1*Math.PI,1.5*Math.PI),t.lineTo(n+r-o,a),t.arc(n+r-o,a+o,o,1.5*Math.PI,0),t.lineTo(n+r,a+i-o),t.arc(n+r-o,a+i-o,o,0,.5*Math.PI),t.lineTo(n+o,a+i),t.arc(n+o,a+i-o,o,.5*Math.PI,1*Math.PI),t.lineTo(n,a+o),t.closePath(),t.setLineWidth(s||1),t.setStrokeStyle(u||"black"),t.stroke()}function v(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.dx,a=e.dy,r=e.width,i=e.height,o=e.r,s=e.backgroundColor;o=o||.1*r,r<2*o&&(o=r/2),r<2*o&&(o=r/2),t.beginPath(),t.arc(n+o,a+o,o,1*Math.PI,1.5*Math.PI),t.lineTo(n+r-o,a),t.arc(n+r-o,a+o,o,1.5*Math.PI,0),t.lineTo(n+r,a+i-o),t.arc(n+r-o,a+i-o,o,0,.5*Math.PI),t.lineTo(n+o,a+i),t.arc(n+o,a+i-o,o,.5*Math.PI,1*Math.PI),t.lineTo(n,a+o),t.closePath(),t.setFillStyle(s),t.fill()}function b(t,e,n){if(l.default.log("进入设置文字方法, texts:"+JSON.stringify(e)),!e||!l.default.isArray(e))return l.default.log("texts是对象"),e=y(t,e,n),l.default.log("返回texts:"+JSON.stringify(e)),e;if(l.default.log("texts是数组"),e.length>0)for(var a=0;a<e.length;a++)l.default.log("字符串信息-初始化之前:"+JSON.stringify(e[a])),e[a]=y(t,e[a],n)}function y(t,e,n){if(l.default.log("进入设置文字方法, textItem:"+JSON.stringify(e)),l.default.isNotNull_string(e.text)){e.text=String(e.text),e.alpha=void 0!==e.alpha?Number(e.alpha):1,e.color=e.color||"black",e.size=void 0!==e.size?Number(e.size):10,e.textAlign=e.textAlign||"left",e.textBaseline=e.textBaseline||"middle",e.dx=Number(e.dx)||0,e.dy=Number(e.dy)||0,e.size=Math.ceil(Number(e.size)),l.default.log("字符串信息-初始化默认值后:"+JSON.stringify(e));var a=w(t,{text:e.text,size:e.size});l.default.log("字符串信息-初始化时的文本长度:"+a);var r={};e.infoCallBack&&"function"===typeof e.infoCallBack&&(r=e.infoCallBack(a)),r.size&&(a=w(t,{text:e.text,size:e.size})),e=(0,s.default)((0,s.default)((0,s.default)({},e),r),{},{textLength:a}),l.default.log("字符串信息-infoCallBack后:"+JSON.stringify(e))}return e}function x(t,e,n){if(e.text&&e.lineFeed){l.default.log("设置换行");var a,r=-1,i=n.width,o=e.size,u=e.dx;if(l.default.isObject(e.lineFeed)){var c=e.lineFeed;r=void 0!==c.lineNum&&"number"===typeof c.lineNum&&c.lineNum>=0?c.lineNum:r,i=void 0!==c.maxWidth&&"number"===typeof c.maxWidth?c.maxWidth:i,a=void 0!==c.lastLineMaxWidth&&"number"===typeof c.lastLineMaxWidth?c.lastLineMaxWidth:i,o=void 0!==c.lineHeight&&"number"===typeof c.lineHeight?c.lineHeight:o,u=void 0!==c.dx&&"number"===typeof c.dx?c.dx:u}l.default.lineFeedTags.forEach((function(t){e.text=e.text.split(t).join(l.default.tagetLineFeedTag)}));for(var d=e.text.split(""),f="",h=[],g=0,m=d.length;g<m;g++)d[g]!==l.default.tagetLineFeedTag?w(t,{text:f,size:e.size})<=i&&w(t,{text:f+d[g],size:e.size})<=i?(f+=d[g],g==d.length-1&&h.push(f)):(h.push(f),f=d[g],g==d.length-1&&h.push(d[g])):(h.push(f),f=d[++g]);l.default.log("循环出的文本数组:"+JSON.stringify(h));for(var p=r>=0&&r<h.length?r:h.length,v=[],b=0;b<p;b++){var y=h[b];if(b==p-1&&p<h.length&&h.length>1){for(var x=y.split(""),k="",P=0,N=x.length;P<N;P++)w(t,{text:k,size:e.size})<=a&&w(t,{text:k+x[P],size:e.size})<=a&&(k+=x[P]);y=k,w(t,{text:y,size:e.size})>.9*(a-e.size)&&(y=y.substring(0,y.length-1)+"...")}var S=(0,s.default)((0,s.default)({},e),{},{text:y,dx:0===b?e.dx:u>=0?u:e.dx,dy:e.dy+b*o,textLength:w(t,{text:y,size:e.size})});l.default.log("重新组成的文本对象:"+JSON.stringify(S)),v.push(S)}l.default.log("newArr: -----",JSON.stringify(v));var T=v.length>1?v:v[0];return T}return e}function w(t,e){l.default.log("计算文字长度, obj:"+JSON.stringify(e));var n,a=e.text,r=e.size;t.setFontSize(r);try{n=t.measureText(a)}catch(c){n={}}if(l.default.log("measureText计算文字长度, textLength:"+JSON.stringify(n)),n=n&&n.width?n.width:0,!n){for(var i=0,o=0;o<a.length;o++){var s=a.substr(o,1),u=k(s);l.default.log("计算文字宽度系数:"+u),i+=u}l.default.log("文字宽度总系数:"+i),n=i*r}return n}function k(t){var e;return e=/a/.test(t)?.552734375:/b/.test(t)?.638671875:/c/.test(t)?.50146484375:/d/.test(t)?.6396484375:/e/.test(t)?.5673828125:/f/.test(t)?.3466796875:/g/.test(t)?.6396484375:/h/.test(t)?.61572265625:/i/.test(t)?.26611328125:/j/.test(t)?.26708984375:/k/.test(t)?.54443359375:/l/.test(t)?.26611328125:/m/.test(t)?.93701171875:/n/.test(t)?.6162109375:/o/.test(t)?.6357421875:/p/.test(t)?.638671875:/q/.test(t)?.6396484375:/r/.test(t)?.3818359375:/s/.test(t)?.462890625:/t/.test(t)?.37255859375:/u/.test(t)?.6162109375:/v/.test(t)?.52490234375:/w/.test(t)?.78955078125:/x/.test(t)?.5068359375:/y/.test(t)?.529296875:/z/.test(t)?.49169921875:/A/.test(t)?.70361328125:/B/.test(t)?.62744140625:/C/.test(t)?.6689453125:/D/.test(t)?.76171875:/E/.test(t)?.5498046875:/F/.test(t)?.53125:/G/.test(t)?.74365234375:/H/.test(t)?.7734375:/I/.test(t)?.2939453125:/J/.test(t)?.39599609375:/K/.test(t)?.634765625:/L/.test(t)?.51318359375:/M/.test(t)?.97705078125:/N/.test(t)?.81298828125:/O/.test(t)?.81494140625:/P/.test(t)?.61181640625:/Q/.test(t)?.81494140625:/R/.test(t)?.65283203125:/S/.test(t)?.5771484375:/T/.test(t)?.5732421875:/U/.test(t)?.74658203125:/V/.test(t)?.67626953125:/W/.test(t)?1.017578125:/X/.test(t)?.64501953125:/Y/.test(t)?.603515625:/Z/.test(t)?.6201171875:/[0-9]/.test(t)?.58642578125:/[\u4e00-\u9fa5]/.test(t)?1:/ /.test(t)?.2958984375:/\`/.test(t)?.294921875:/\~/.test(t)?.74169921875:/\!/.test(t)?.3125:/\@/.test(t)?1.03125:/\#/.test(t)?.63818359375:/\$/.test(t)?.58642578125:/\%/.test(t)?.8896484375:/\^/.test(t)?.74169921875:/\&/.test(t)?.8701171875:/\*/.test(t)?.455078125:/\(/.test(t)||/\)/.test(t)?.333984375:/\_/.test(t)?.4482421875:/\-/.test(t)?.4326171875:/\+/.test(t)||/\=/.test(t)?.74169921875:/\|/.test(t)?.26904296875:/\\/.test(t)?.416015625:/\[/.test(t)||/\]/.test(t)?.333984375:/\;/.test(t)?.24072265625:/\'/.test(t)?.25634765625:/\,/.test(t)||/\./.test(t)?.24072265625:/\//.test(t)?.42724609375:/\{/.test(t)||/\}/.test(t)?.333984375:/\:/.test(t)?.24072265625:/\"/.test(t)?.435546875:/\</.test(t)||/\>/.test(t)?.74169921875:/\?/.test(t)?.48291015625:1,e}function P(t){return l.default.log("进入设置图片数据方法"),new Promise(function(){var e=(0,u.default)((0,i.default)().mark((function e(n,a){var r;return(0,i.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,!t||!l.default.isArray(t)){e.next=14;break}l.default.log("images是一个数组"),r=0;case 4:if(!(r<t.length)){e.next=12;break}return l.default.log("设置图片数据循环中:"+r),e.next=8,S(t[r]);case 8:t[r]=e.sent;case 9:r++,e.next=4;break;case 12:e.next=18;break;case 14:return l.default.log("images是一个对象"),e.next=17,S(t);case 17:t=e.sent;case 18:n(t),e.next=24;break;case 21:e.prev=21,e.t0=e["catch"](0),a(e.t0);case 24:case"end":return e.stop()}}),e,null,[[0,21]])})));return function(t,n){return e.apply(this,arguments)}}())}function N(t){return/^\s*data:([a-z]+\/[a-z0-9-+.]+(;[a-z-]+=[a-z0-9-]+)?)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s]*?)\s*$/i.test(t)?(0,d.base64ToPath)(t):Promise.resolve(t)}function S(t){return new Promise(function(){var e=(0,u.default)((0,i.default)().mark((function e(n,a){var r,o,u,c;return(0,i.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.url){e.next=21;break}return e.next=3,N(t.url);case 3:return t.url=e.sent,r=t.url,o=r,e.next=8,l.default.downloadFile_PromiseFc(r);case 8:return r=e.sent,t.url=r,u=t.infoCallBack&&"function"===typeof t.infoCallBack,c={},e.next=14,l.default.getImageInfo_PromiseFc(o);case 14:c=e.sent,u&&(t=(0,s.default)((0,s.default)({},t),t.infoCallBack(c))),t.dx=Number(t.dx)||0,t.dy=Number(t.dy)||0,t.dWidth=Number(t.dWidth||c.width),t.dHeight=Number(t.dHeight||c.height),t=(0,s.default)((0,s.default)({},t),{},{imageInfo:c});case 21:n(t);case 22:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())}function T(t,e,n){l.default.isArray(e)?l.default.log("遍历文本方法, 是数组"):(l.default.log("遍历文本方法, 不是数组"),e=[e]),l.default.log("遍历文本方法, textArray:"+JSON.stringify(e));var a=e;(function(t,e){if(l.default.log("准备绘制文本方法, texts:"+JSON.stringify(e)),e&&l.default.isArray(e)){if(l.default.log("准备绘制文本方法, 是数组"),e.length>0)for(var n=0;n<e.length;n++)I(t,e[n])}else l.default.log("准备绘制文本方法, 不是数组"),I(t,e)})(t,a)}function I(t,e){if(l.default.log("进入绘制文本方法, textItem:"+JSON.stringify(e)),e&&l.default.isObject(e)&&e.text){if(t.font=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(t.font&&"string"===typeof t.font)return l.default.log(t.font),t.font;var e="normal",n="normal",a="normal",r=t.size||10,i="sans-serif";return r=Math.ceil(Number(r)),t.fontStyle&&"string"===typeof t.fontStyle&&(e=t.fontStyle.trim()),t.fontVariant&&"string"===typeof t.fontVariant&&(n=t.fontVariant.trim()),!t.fontWeight||"string"!==typeof t.fontWeight&&"number"!==typeof t.fontWeight||(a=t.fontWeight.trim()),t.fontFamily&&"string"===typeof t.fontFamily&&(i=t.fontFamily.trim()),e+" "+n+" "+a+" "+r+"px "+i}(e),t.setFillStyle(e.color),t.setGlobalAlpha(e.alpha),t.setTextAlign(e.textAlign),t.setTextBaseline(e.textBaseline),t.fillText(e.text,e.dx,e.dy),e.lineThrough&&l.default.isObject(e.lineThrough)){l.default.log("有删除线");var n,a,r=e.lineThrough;switch(r.alpha=void 0!==r.alpha?r.alpha:e.alpha,r.style=r.style||e.color,r.width=void 0!==r.width?r.width:e.size/10,r.cap=void 0!==r.cap?r.cap:"butt",l.default.log("删除线对象:"+JSON.stringify(r)),t.setGlobalAlpha(r.alpha),t.setStrokeStyle(r.style),t.setLineWidth(r.width),t.setLineCap(r.cap),e.textAlign){case"left":n=e.dx;break;case"center":n=e.dx-e.textLength/2;break;default:n=e.dx-e.textLength;break}switch(e.textBaseline){case"top":a=e.dy+.5*e.size;break;case"middle":a=e.dy;break;default:a=e.dy-.5*e.size;break}t.beginPath(),t.moveTo(n,a),t.lineTo(n+e.textLength,a),t.stroke(),t.closePath(),l.default.log("删除线完毕")}t.setGlobalAlpha(1),t.font="10px sans-serif"}}function L(t,e){if(l.default.log("判断图片数据类型:"+JSON.stringify(e)),e&&l.default.isArray(e)){if(e.length>0)for(var n=0;n<e.length;n++)C(t,e[n])}else C(t,e)}function C(t,e){l.default.log("判断绘制图片形状, img:"+JSON.stringify(e)),e.url&&(e.circleSet?function(t,e){l.default.log("进入绘制圆形图片方法, obj:"+JSON.stringify(e));var n,a,i,o=e.dx,s=e.dy,u=e.dWidth,c=e.dHeight,d=e.circleSet;e.imageInfo;"object"===(0,r.default)(d)&&(n=d.x,a=d.y,i=d.r);if(!i){var f;f=u>c?c:u,i=f/2}n=n?o+n:(o||0)+i,a=a?s+a:(s||0)+i,t.save(),t.beginPath(),t.arc(n,a,i,0,2*Math.PI,!1),t.closePath(),t.setGlobalAlpha(0),t.fillStyle="#FFFFFF",t.fill(),t.setGlobalAlpha(1),t.clip(),F(t,e),l.default.log("默认图片绘制完毕"),t.restore()}(t,e):e.roundRectSet?function(t,e){l.default.log("进入绘制矩形图片方法, obj:"+JSON.stringify(e)),t.save();var n,a=e.dx,i=e.dy,o=e.dWidth,s=e.dHeight,u=e.roundRectSet;e.imageInfo;"object"===(0,r.default)(u)&&(n=u.r);n=n||.1*o,o<2*n&&(n=o/2);s<2*n&&(n=s/2);t.beginPath(),t.arc(a+n,i+n,n,1*Math.PI,1.5*Math.PI),t.lineTo(a+o-n,i),t.arc(a+o-n,i+n,n,1.5*Math.PI,0),t.lineTo(a+o,i+s-n),t.arc(a+o-n,i+s-n,n,0,.5*Math.PI),t.lineTo(a+n,i+s),t.arc(a+n,i+s-n,n,.5*Math.PI,1*Math.PI),t.lineTo(a,i+n),t.closePath(),t.setGlobalAlpha(0),t.fillStyle="#FFFFFF",t.fill(),t.setGlobalAlpha(1),t.clip(),F(t,e),t.restore(),l.default.log("进入绘制矩形图片方法, 绘制完毕")}(t,e):F(t,e))}var A={scaleToFill:function(t,e){l.default.log("准备绘制mode为scaleToFill的图片"),t.drawImage(e.url,Number(e.dx||0),Number(e.dy||0),Number(e.dWidth)||!1,Number(e.dHeight)||!1),l.default.log("mode为scaleToFill的图片绘制完毕")},aspectFit:function(t,e){l.default.log("准备绘制mode为aspectFit的图片");var n=e.imageInfo,a=e.dWidth,r=e.dHeight,i=n.height,o=n.width,s=a,u=i/o*s;if(u<r){var c=(Number(r)-Number(u))/Number(r)*i;e.dy=Number(e.dy)+c/2}else{u=r,s=o/i*u;var d=(Number(a)-Number(s))/Number(a)*o;e.dx=Number(e.dx)+d/2}t.drawImage(e.url,0,0,o,i,e.dx,e.dy,s,u),l.default.log("mode为aspectFit的图片绘制完毕")},aspectFill:function(t,e){uni.getSystemInfoSync().pixelRatio;l.default.log("准备绘制mode为aspectFill的图片");var n=e.imageInfo,a=e.dWidth,r=e.dHeight,i=n.height,o=n.width,s=0,u=0,c=o,d=i,f=a,h=i/o*f;if(h<r){l.default.log("绘制高度 小于 预定高度"),h=r,f=o/i*h;var g=(Number(f)-Number(a))/Number(f)*o;s=g/2,c=o-g}else{var m=(Number(h)-Number(r))/Number(h)*i;u=m/2,d=i-m}l.default.log("aspectFill 最终绘制: sx: ".concat(s,", sy: ").concat(u,", sWidth: ").concat(c,", sHeight: ").concat(d,", dx: ").concat(e.dx,", dy: ").concat(e.dy,", dWidth: ").concat(a,", dHeight: ").concat(r)),t.drawImage(e.url,s,u,c,d,e.dx,e.dy,a,r),l.default.log("mode为aspectFill的图片绘制完毕")}};function F(t,e){if(l.default.log("进入绘制默认图片方法, img:"+JSON.stringify(e)),e.url){var n=!l.default.isUndef(e.alpha);e.alpha=Number(l.default.isUndef(e.alpha)?1:e.alpha),t.setGlobalAlpha(e.alpha),l.default.log("绘制默认图片方法, 有url"),void 0===e.dHeight&&(e.dHeight=e.imageInfo.height),void 0===e.dWidth&&(e.dWidth=e.imageInfo.width);var a=A[e.mode];a?a(t,e):e.dWidth&&e.dHeight&&e.sx&&e.sy&&e.sWidth&&e.sHeight?(l.default.log("绘制默认图片方法, 绘制第一种方案"),t.drawImage(e.url,Number(e.sx)||!1,Number(e.sy)||!1,Number(e.sWidth)||!1,Number(e.sHeight)||!1,Number(e.dx||0),Number(e.dy||0),Number(e.dWidth)||!1,Number(e.dHeight)||!1)):e.dWidth&&e.dHeight?(l.default.log("绘制默认图片方法, 绘制第二种方案"),t.drawImage(e.url,Number(e.dx||0),Number(e.dy||0),Number(e.dWidth)||!1,Number(e.dHeight)||!1)):(l.default.log("绘制默认图片方法, 绘制第三种方案"),t.drawImage(e.url,Number(e.dx||0),Number(e.dy||0))),n&&t.setGlobalAlpha(1)}l.default.log("绘制默认图片方法, 绘制完毕")}function O(t,e){l.default.log("进入绘制二维码方法"),l.default.showLoading("正在生成二维码");for(var n=[],a={text:String(e.text||"")||"",size:Number(e.size||0)||200,background:String(e.background||"")||"#ffffff",foreground:String(e.foreground||"")||"#000000",pdground:String(e.pdground||"")||"#000000",correctLevel:Number(e.correctLevel||0)||3,image:String(e.image||"")||"",imageSize:Number(e.imageSize||0)||40,dx:Number(e.dx||0)||0,dy:Number(e.dy||0)||0},r=null,i=0,o=0,s=n.length;o<s;o++)if(i=o,n[o].text==a.text&&n[o].text.correctLevel==a.correctLevel){r=n[o].obj;break}i==s&&(r=new c.default(a.text,a.correctLevel),n.push({text:a.text,correctLevel:a.correctLevel,obj:r}));for(var u=function(t){var e=t.options;return e.pdground&&(t.row>1&&t.row<5&&t.col>1&&t.col<5||t.row>t.count-6&&t.row<t.count-2&&t.col>1&&t.col<5||t.row>1&&t.row<5&&t.col>t.count-6&&t.col<t.count-2)?e.pdground:e.foreground},d=r.getModuleCount(),f=a.size,h=a.imageSize,g=(f/d).toPrecision(4),m=(f/d).toPrecision(4),p=0;p<d;p++)for(var v=0;v<d;v++){var b=Math.ceil((v+1)*g)-Math.floor(v*g),y=Math.ceil((p+1)*g)-Math.floor(p*g),x=u({row:p,col:v,count:d,options:a});t.setFillStyle(r.modules[p][v]?x:a.background),t.fillRect(a.dx+Math.round(v*g),a.dy+Math.round(p*m),b,y)}if(a.image){var w=a.dx+Number(((f-h)/2).toFixed(2)),k=a.dy+Number(((f-h)/2).toFixed(2));(function(t,e,n,r,i,o,s,u,l){t.setLineWidth(s),t.setFillStyle(a.background),t.setStrokeStyle(a.background),t.beginPath(),t.moveTo(e+o,n),t.arcTo(e+r,n,e+r,n+o,o),t.arcTo(e+r,n+i,e+r-o,n+i,o),t.arcTo(e,n+i,e,n+i-o,o),t.arcTo(e,n,e+o,n,o),t.closePath(),u&&t.fill(),l&&t.stroke()})(t,w,k,h,h,2,6,!0,!0),t.drawImage(a.image,w,k,h,h)}l.default.log("进入绘制二维码方法完毕"),l.default.hideLoading()}function B(t){t.backgroundImage,t.type;return new Promise(function(){var e=(0,u.default)((0,i.default)().mark((function e(n,a){var r;return(0,i.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,l.default.showLoading("正在获取海报背景图"),e.next=4,E(t);case 4:r=e.sent,l.default.hideLoading(),n(r),e.next=15;break;case 9:e.prev=9,e.t0=e["catch"](0),l.default.hideLoading(),l.default.showToast("获取分享用户背景图失败:"+JSON.stringify(e.t0)),l.default.log(JSON.stringify(e.t0)),a(e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t,n){return e.apply(this,arguments)}}())}function E(t,e){var n=t.backgroundImage;t.type;return l.default.log("获取分享背景图, 尝试清空本地数据"),new Promise(function(){var e=(0,u.default)((0,i.default)().mark((function e(a,r){var o,u,c,d,f;return(0,i.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,l.default.showLoading("正在下载海报背景图"),l.default.log("没有从后端获取的背景图片路径, 尝试从后端获取背景图片路径"),!n.includes("thirdwx.qlogo")){e.next=36;break}if(!n){e.next=8;break}e.t0=n,e.next=11;break;case 8:return e.next=10,l.default.getPosterUrl(t);case 10:e.t0=e.sent;case 11:return o=e.t0,e.next=14,N(o);case 14:return o=e.sent,l.default.log("尝试下载并保存背景图:"+o),e.next=18,l.default.downLoadAndSaveFile_PromiseFc(o);case 18:if(u=e.sent,!u){e.next=32;break}return l.default.log("下载并保存背景图成功:"+u),e.next=23,l.default.getImageInfo_PromiseFc(o);case 23:c=e.sent,l.default.log("获取图片信息成功"),d={path:u,width:c.width,height:c.height,name:l.default.fileNameInPath(o)},l.default.log("拼接背景图信息对象成功:"+JSON.stringify(d)),l.default.hideLoading(),l.default.log("返回背景图信息对象"),a((0,s.default)({},d)),e.next=34;break;case 32:l.default.hideLoading(),r("not find savedFilePath");case 34:e.next=40;break;case 36:return e.next=38,l.default.getImageInfo_PromiseFc(n);case 38:f=e.sent,a({path:n,width:f.width,height:f.height,name:l.default.fileNameInPath(n)});case 40:e.next=45;break;case 42:e.prev=42,e.t1=e["catch"](0),r(e.t1);case 45:case"end":return e.stop()}}),e,null,[[0,42]])})));return function(t,n){return e.apply(this,arguments)}}())}t.exports={getSharePoster:function(t){var e=t.type,n=t.formData,a=t.background,r=t.posterCanvasId,c=t.backgroundImage,d=t.reserve,g=t.textArray,m=t.drawArray,p=t.qrCodeArray,v=t.imagesArray,y=t.setCanvasWH,k=t.setCanvasToTempFilePath,N=t.canvas2image,S=t.setDraw,T=t.bgScale,I=t.Context,L=t._this,C=t.delayTimeScale,A=t.drawDelayTime,F=t.draw;return new Promise(function(){var t=(0,u.default)((0,i.default)().mark((function t(u,O){var E,_,j,M,z,R,D,J,H,W,G,U;return(0,i.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,l.default.showLoading("正在准备海报数据"),I||(l.default.log("没有画布对象,创建画布对象"),I=uni.createCanvasContext(r,L||null)),!(a&&a.width&&a.height)){t.next=7;break}E=a,t.next=10;break;case 7:return t.next=9,B({backgroundImage:c,type:e,formData:n});case 9:E=t.sent;case 10:if(T=T||1,E.width=E.width*T,E.height=E.height*T,l.default.log("获取背景图信息对象成功:"+JSON.stringify(E)),_={bgObj:E,type:e,bgScale:T,getBgObj:function(){return _.bgObj},setBgObj:function(t){var e=(0,s.default)((0,s.default)({},_.bgObj),t);_.bgObj=e,E=e}},!v){t.next=23;break}return"function"==typeof v&&(v=v(_)),l.default.showLoading("正在生成需绘制图片的临时路径"),l.default.log("准备设置图片"),t.next=21,P(v);case 21:v=t.sent,l.default.hideLoading();case 23:if(g&&("function"==typeof g&&(g=g(_)),g=b(I,g)),!p){t.next=38;break}"function"==typeof p&&(p=p(_)),l.default.showLoading("正在生成需绘制图片的临时路径"),j=0;case 28:if(!(j<p.length)){t.next=37;break}if(l.default.log(j),!p[j].image){t.next=34;break}return t.next=33,l.default.downloadFile_PromiseFc(p[j].image);case 33:p[j].image=t.sent;case 34:j++,t.next=28;break;case 37:l.default.hideLoading();case 38:if(!m){t.next=92;break}if("function"==typeof m&&(m=m(_)),!l.default.isPromise(m)){t.next=44;break}return t.next=43,m;case 43:m=t.sent;case 44:if(!(l.default.isArray(m)&&m.length>0)){t.next=92;break}[],M=0;case 47:if(!(M<m.length)){t.next=79;break}z=m[M],z[f]=M,R=void 0,D=!1,t.t0=z.type,t.next="image"===t.t0?55:"text"===t.t0?59:"qrcode"===t.t0?61:"custom"===t.t0?67:"fillrect"===t.t0?68:"strokeRect"===t.t0?69:"roundStrokeRect"===t.t0?70:"roundFillRect"===t.t0?71:72;break;case 55:return t.next=57,P(z);case 57:return R=t.sent,t.abrupt("break",74);case 59:return R=b(I,z,_.bgObj),t.abrupt("break",74);case 61:if(!z.image){t.next=66;break}return t.next=64,l.default.downloadFile_PromiseFc(z.image);case 64:t.t1=t.sent,R={image:t.t1};case 66:return t.abrupt("break",74);case 67:return t.abrupt("break",74);case 68:return t.abrupt("break",74);case 69:return t.abrupt("break",74);case 70:return t.abrupt("break",74);case 71:return t.abrupt("break",74);case 72:return l.default.log("未识别的类型"),t.abrupt("break",74);case 74:!D&&R&&l.default.isObject(R)&&(m[M]=(0,s.default)((0,s.default)({},z),R));case 76:M++,t.next=47;break;case 79:J=(0,o.default)(m),J.sort((function(t,e){var n=l.default.isUndef(t.serialNum)||l.default.isNull(t.serialNum)?Number.NEGATIVE_INFINITY:Number(t.serialNum),a=l.default.isUndef(e.serialNum)||l.default.isNull(e.serialNum)?Number.NEGATIVE_INFINITY:Number(e.serialNum);return n-a})),l.default.log("开始for循环"),H=(0,i.default)().mark((function t(e){var n,a,r,u,c,d,h;return(0,i.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=(0,s.default)({},J[e]),a=n[f],l.default.log("item_idKey",a),r=m.findIndex((function(t){return t[f]==a})),l.default.log("ind",r),-1!=r){t.next=7;break}return t.abrupt("return","break");case 7:if(!l.default.isFn(n.allInfoCallback)){t.next=16;break}if(u=n.allInfoCallback({drawArray:m}),l.default.log("newData",JSON.stringify(u)),!l.default.isPromise(u)){t.next=14;break}return t.next=13,u;case 13:u=t.sent;case 14:"text"===m[r].type&&u.size&&(c=w(I,{text:u.text||m[r].text,size:u.size}),u.textLength=c),m[r]=(0,s.default)((0,s.default)({},n),u);case 16:l.default.log("drawArray[ind]",JSON.stringify(m[r])),"text"===m[r].type&&(d=x(I,m[r],_.bgObj),l.default.isArray(d)?(d.forEach((function(t,e){t[f]=m.length+e,t.allInfoCallback=null})),(h=m).splice.apply(h,[r,1].concat((0,o.default)(d)))):m.splice(r,1,d));case 18:case"end":return t.stop()}}),t)})),W=0;case 84:if(!(W<J.length)){t.next=92;break}return t.delegateYield(H(W),"t2",86);case 86:if(G=t.t2,"break"!==G){t.next=89;break}return t.abrupt("break",92);case 89:W++,t.next=84;break;case 92:if(m.sort((function(t,e){var n=l.default.isUndef(t.zIndex)||l.default.isNull(t.zIndex)?Number.NEGATIVE_INFINITY:Number(t.zIndex),a=l.default.isUndef(e.zIndex)||l.default.isNull(e.zIndex)?Number.NEGATIVE_INFINITY:Number(e.zIndex);return n-a})),l.default.log("params:"+JSON.stringify(_)),!y||"function"!=typeof y){t.next=97;break}return t.next=97,new Promise((function(t,e){y(_),setTimeout((function(){t()}),50)}));case 97:return t.next=99,h({Context:I,type:e,posterCanvasId:r,reserve:d,drawArray:m,textArray:g,imagesArray:v,bgObj:E,qrCodeArray:p,setCanvasToTempFilePath:k,setDraw:S,bgScale:T,_this:L,delayTimeScale:C,drawDelayTime:A,canvas2image:N,draw:F});case 99:U=t.sent,l.default.hideLoading(),u({bgObj:E,poster:U,type:e}),t.next=107;break;case 104:t.prev=104,t.t3=t["catch"](0),O(t.t3);case 107:case"end":return t.stop()}}),t,null,[[0,104]])})));return function(e,n){return t.apply(this,arguments)}}())},setText:b,setImage:P,drawText:T,drawImage:L,drawQrCode:O,drawFillRect:g,drawStrokeRect:m,drawRoundStrokeRect:p,drawRoundFillRect:v}}}]);